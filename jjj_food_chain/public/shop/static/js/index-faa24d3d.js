import{b as e,c as t,d as i,e as o}from"./element-plus-0b11a037.js";import{_ as r,u as s}from"./index-7abb690d.js";import{o as l,c as a,a as n,P as d,S as m,V as h,X as u,a1 as c,W as p}from"./@vue-5441e37d.js";import{I as f}from"./index-fb0c5f7e.js";import{U as g}from"./user-241de972.js";import"./@vueuse-d256812d.js";import"./lodash-es-d1425fe7.js";import"./async-validator-cf877c1f.js";import"./@element-plus-2416ebe7.js";import"./dayjs-9faf8871.js";import"./call-bind-0c463fe3.js";import"./get-intrinsic-bac01933.js";import"./has-symbols-456daba2.js";import"./has-proto-4a87f140.js";import"./function-bind-72d06d3b.js";import"./has-885c3436.js";import"./escape-html-1935ddb3.js";import"./normalize-wheel-es-3222b0a2.js";import"./@ctrl-91de2ec7.js";import"./vue-router-e88e0a38.js";import"./pinia-f65196e0.js";import"./vue-demi-71ba0ef2.js";import"./axios-85bcd05e.js";import"./qs-942d6868.js";import"./side-channel-ba7aab8a.js";import"./object-inspect-860361a9.js";import"./vue-ueditor-wrap-026a3d0f.js";const y={class:"s-canvas"},b=["width","height"];const C=r({name:"SIdentify",props:{identifyCode:{type:String,default:"1234"},fontSizeMin:{type:Number,default:25},fontSizeMax:{type:Number,default:30},backgroundColorMin:{type:Number,default:255},backgroundColorMax:{type:Number,default:255},colorMin:{type:Number,default:0},colorMax:{type:Number,default:160},lineColorMin:{type:Number,default:100},lineColorMax:{type:Number,default:255},dotColorMin:{type:Number,default:0},dotColorMax:{type:Number,default:255},contentWidth:{type:Number,default:112},contentHeight:{type:Number,default:41}},methods:{randomNum:(e,t)=>Math.floor(Math.random()*(t-e)+e),randomColor(e,t){return"rgb("+this.randomNum(e,t)+","+this.randomNum(e,t)+","+this.randomNum(e,t)+")"},drawPic(){let e=document.getElementById("s-canvas").getContext("2d");e.textBaseline="bottom",e.fillStyle=this.randomColor(this.backgroundColorMin,this.backgroundColorMax),e.fillRect(0,0,this.contentWidth,this.contentHeight);for(let t=0;t<this.identifyCode.length;t++)this.drawText(e,this.identifyCode[t],t);this.drawLine(e),this.drawDot(e)},drawText(e,t,i){e.fillStyle=this.randomColor(this.colorMin,this.colorMax),e.font=this.randomNum(this.fontSizeMin,this.fontSizeMax)+"px SimHei";let o=(i+1)*(this.contentWidth/(this.identifyCode.length+1)),r=this.randomNum(this.fontSizeMax,this.contentHeight-5);var s=this.randomNum(-45,45);e.translate(o,r),e.rotate(s*Math.PI/180),e.fillText(t,0,0),e.rotate(-s*Math.PI/180),e.translate(-o,-r)},drawLine(e){for(let t=0;t<5;t++)e.strokeStyle=this.randomColor(this.lineColorMin,this.lineColorMax),e.beginPath(),e.moveTo(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight)),e.lineTo(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight)),e.stroke()},drawDot(e){for(let t=0;t<80;t++)e.fillStyle=this.randomColor(0,255),e.beginPath(),e.arc(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight),1,0,2*Math.PI),e.fill()}},watch:{identifyCode(){this.drawPic()}},mounted(){this.drawPic()}},[["render",function(e,t,i,o,r,s){return l(),a("div",y,[n("canvas",{id:"s-canvas",width:i.contentWidth,height:i.contentHeight},null,8,b)])}],["__scopeId","data-v-00d68c2f"]]),v=""+new URL("../png/login_bg-12ac142e.png",import.meta.url).href,x=""+new URL("../png/login_logo-b4613a41.png",import.meta.url).href,j=""+new URL("../png/user-5b600d84.png",import.meta.url).href,w=""+new URL("../png/password-589fc893.png",import.meta.url).href,{afterLogin:N}=s(),M={components:{sidentify:C},data(){return{loginForm:{},identifyCodes:"1234567890",identifyCode:"",loading:!0,shop_name:"",bgimg_url:"",log_url:"",logining:!1,ruleForm:{account:"admin",checkPass:"123456",verifycode:""},rules:{account:[{required:!0,message:"请输入用户名",trigger:"blur"}],checkPass:[{required:!0,message:"请输入密码",trigger:"blur"}],verifycode:[{required:!0,trigger:"blur",validator:(e,t,i)=>{""===t?(this.refreshCode(),i(new Error("请输入验证码"))):t!==this.identifyCode?(this.refreshCode(),i(new Error("验证码不正确!"))):i()}}]},baseData:{}}},created(){this.refreshCode(),this.getData()},mounted(){this.identifyCode="",this.makeCode(this.identifyCodes,4)},methods:{randomNum:(e,t)=>Math.floor(Math.random()*(t-e)+e),refreshCode(){this.identifyCode="",this.makeCode(this.identifyCodes,4)},makeCode(e,t){for(let i=0;i<t;i++)this.identifyCode+=this.identifyCodes[this.randomNum(0,this.identifyCodes.length)]},getData(){let e=this;f.base(!0).then((t=>{e.loading=!1;const{data:{settings:{shop_bg_img:i,shop_name:o,shop_logo_img:r}}}=t;e.shop_name=o,e.bgimg_url=i||v,e.log_url=r||x})).catch((t=>{e.loading=!1}))},SubmitFunc(e){var t=this;this.$refs.ruleForm.validate((e=>{if(e){this.logining=!0;var i={username:this.ruleForm.account,password:this.ruleForm.checkPass};g.login(i,!0).then((async e=>{await N(e),t.logining=!1,t.$router.push({path:"/home"})})).catch((e=>{t.logining=!1}))}}))}}},_={class:"log_img"},k=["src"],F={class:"flex-1 login-box"},P={class:"title",style:{"margin-bottom":"20px"}},S={class:"left-img-input"},V=n("img",{class:"l-img",src:j},null,-1),H={class:"left-img-input"},U=n("img",{class:"l-img",src:w},null,-1),W={class:"d-b-c"},z={class:"left-img-input",style:{width:"auto"}};const I=r(M,[["render",function(r,s,f,g,y,b){const v=t,x=i,j=C,w=o,N=e;return l(),a("div",{class:"login-bg",style:h("background-image:url("+y.bgimg_url+");")},[n("div",null,[d(N,{model:y.ruleForm,rules:y.rules,ref:"ruleForm","label-position":"left","label-width":"0px",class:"demo-ruleForm login-container d-b-c"},{default:m((()=>[n("div",_,[n("img",{src:y.log_url},null,8,k)]),n("div",F,[n("h3",P,u(y.shop_name),1),d(x,{prop:"account"},{default:m((()=>[n("div",S,[V,d(v,{class:"l-input",type:"text",modelValue:y.ruleForm.account,"onUpdate:modelValue":s[0]||(s[0]=e=>y.ruleForm.account=e),"auto-complete":"off",placeholder:"账号"},null,8,["modelValue"])])])),_:1}),d(x,{prop:"checkPass"},{default:m((()=>[n("div",H,[U,d(v,{type:"password",class:"l-input",modelValue:y.ruleForm.checkPass,"onUpdate:modelValue":s[1]||(s[1]=e=>y.ruleForm.checkPass=e),"auto-complete":"off",placeholder:"密码"},null,8,["modelValue"])])])),_:1}),d(x,{prop:"verifycode",style:{"line-height":"0px"}},{default:m((()=>[n("div",W,[n("div",z,[d(v,{modelValue:y.ruleForm.verifycode,"onUpdate:modelValue":s[2]||(s[2]=e=>y.ruleForm.verifycode=e),ref:"verifycode",placeholder:"验证码",class:"l-input",style:{width:"230px"}},null,8,["modelValue"])]),n("div",{class:"identifybox",style:{height:"41px","flex-shrink":"0"},onClick:s[3]||(s[3]=(...e)=>b.refreshCode&&b.refreshCode(...e))},[d(j,{identifyCode:y.identifyCode},null,8,["identifyCode"])])])])),_:1}),d(x,null,{default:m((()=>[d(w,{type:"primary",style:{width:"100%",height:"51px","font-size":"18px"},onClick:c(b.SubmitFunc,["prevent"]),loading:y.logining},{default:m((()=>[p("登录 ")])),_:1},8,["onClick","loading"])])),_:1})])])),_:1},8,["model","rules"])])],4)}]]);export{I as default};
