import{_ as t,o as e,c as s,w as i,J as o,g as a,a as l,a2 as c,n as d,e as r,y as u,X as n,k as p,m as _,u as h,p as m,h as f,t as k,b as g,r as w,F as b,d as y,i as A,z as C}from"./index-g5-6g3i5.js";const E=t({name:"popup-layer",model:{prop:"showPop",event:"change"},props:{showPop:{type:Boolean,default:!1},direction:{type:String,default:"top"},autoClose:{type:Boolean,default:!0}},data:()=>({ifshow:!1,translateValue:-150,timer:null,iftoggle:!1}),computed:{_translate(){return{top:`transform:translateY(${-this.translateValue}%)`,bottom:`transform:translateY(${this.translateValue}%)`,left:`transform:translateX(${-this.translateValue}%)`,right:`transform:translateX(${this.translateValue}%)`}[this.direction]},_location(){return{top:"bottom:0;width:100%;",bottom:"top:0px;width:100%;",left:"right:0px;height:100%;",right:"left:0px;height:100%;"}[this.direction]+this._translate}},mounted(){this.showPop&&this.show()},watch:{showPop(t){t?this.show():this.close()}},methods:{stopMove(t){console.log(t)},show(t){this.ifshow=!0,setTimeout((()=>{this.translateValue=0}),100),setTimeout((()=>{this.iftoggle=!0}),300)},close(){null===this.timer&&this.iftoggle&&(this.translateValue=-150,this.translateValue=-150,this.timer=setTimeout((()=>{this.ifshow=!1,this.timer=null,this.iftoggle=!1,this.$emit("closeCallBack",null),this.$emit("change",!1)}),300))},ableClose(){this.autoClose&&this.close()},stopEvent(t){},doSome(){}}},[["render",function(t,u,n,p,_,h){const m=r;return e(),s(m,null,{default:i((()=>[_.ifshow?(e(),s(m,{key:0,onClick:h.ableClose,onTouchmove:u[0]||(u[0]=o((()=>{}),["stop","prevent"])),class:"popup-layer"},null,8,["onClick"])):a("",!0),l(m,{class:"popup-content",onClick:o(h.stopEvent,["stop"]),style:d(h._location)},{default:i((()=>[c(t.$slots,"content",{},void 0,!0)])),_:3},8,["onClick","style"])])),_:3})}],["__scopeId","data-v-c0835a2b"]]),I="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ1IDc5LjE2MzQ5OSwgMjAxOC8wOC8xMy0xNjo0MDoyMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkFCQTREQjA3MjE3QzExRUZCNzYzQjlFQzRDOEQzNEEwIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkFCQTREQjA4MjE3QzExRUZCNzYzQjlFQzRDOEQzNEEwIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QUJBNERCMDUyMTdDMTFFRkI3NjNCOUVDNEM4RDM0QTAiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QUJBNERCMDYyMTdDMTFFRkI3NjNCOUVDNEM4RDM0QTAiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4yOhArAAADX0lEQVR42tyaz2sTQRTHJ0YTEjceTLQkEFSwSfXijxb1Wk+e1IOi+Av0oFQsqODFqgdFD4I/oEjRi1Bs60FR/APs1UpW8aJNFUSjgloRTBqhEur3JbM6rLv5sZlkd3zwoW2ym3nfzs6b917Gl8lk2P9g8yV+1lLQCzaBLrACLAEL+fsz4Ct4CybBEzAOvnhBSBQcAHtAN/BVuTYIFoM02MJfmwM6GAXD4JtTR+Y5vC8OroB34CroqSHCznz8XvqM92AQJNohhGbwFJgCJ4XHRoaFwTGQ5WMsaJWQTvAUXAZaC9etxsegsVbLFrINUHhb18ZAtBZMgO2yhBwG98EiF6Iqzc497kNTQvrATeB3cYvwcx/6nArZyqOIV2yQ+9SQkFVgxOWZsJqZEe5bXUIo7I21ODI1s2bGrEKzlZDjYI2H0yry7UQtIbSrnlMgRzxrzgDMQk7LfKSCwSBLJBJlYrGY7EdswE4IjXRI5miBQIDF4/Ey0WhU9qwc5D7/I2QfCClUgoS4z5ZCVLO9ZiFUFK1XUEi3segNIZsd1hNum49XpX+EbFS4XO8RhXQpLCQtClmpsJBOsfnQ4ag2DYdZMpm0z/L8f3POUCjE0um07bXFYpHlcjknbnSIQiKO0lE4qmma9GsbtEgzXRQv2aw4I3kns5LP55mu6/b/qkiEpVKp8u+FQoFls9lWCMmLM/JZ4Rn5Lgp5o7CQ16KQSYWFZEUhEwoL0UUh1BWfU1AE+fzYvNifKSiEfP5k3kfuKChk1KqwIiE/ZY5SKpXK+wdBKYhkI1+HjT/EL3qmwW1wVNZI5HyLNkHGfZ2266JcpE1YgUeqwH1ldkJo4ZxXQMgFY5HbCSG7Dp57WAT5ds38opWQX2AX+OFBEZQg7uY+1hRi5C/7KfB4SAT5Qi2rKas3q9Ujj0C/h4T0c59Yo0LIhsARl2emxH0YqnZRPRXiLbDDpTVDYXYn94E1K4TsIav0j9oZzV6wSr/tQT0XN1KzUwCgcyYDslMZi9TjDNgAXtZ7U6PNByr0L7FKL4li+YxEAZSM3QApvmvPNnKz0y7KR1Y5wrGc/9Qd1jPGoRr6jGWscoTjgxOHfBLPa1GjrJc/1/TNq3HMSRMWrnHM6RWvSsdlNT5kntcih+5y2m6/BRgAKBupdKidZNQAAAAASUVORK5CYII=";const S=t({components:{},data:()=>({detail:{product_attr:[],product_feed:[],sku:[]},Visible:!1,form:{attr:[],product_sku_id:[],feed:[],detail:{},show_sku:{sku_image:"",bag_price:""},shop_supplier_id:0},stock:0,selectSpec:"",isOpenSpec:!1,type:"",product_price:"",feed_price:0,space_name:"",attr_name:[],feed_name:[],product_lineprice:"",delivery:"",bag_type:1,dinner_type:20,cart_type:0,table_id:0,clock:!1,discount_price:0,product_id:"",isContentVideoPlay:!1,isMPH5:!1,loading:!0}),computed:{price:function(){return this.discount_price?((1*this.discount_price+1*this.product_price)*this.form.show_sku.sum).toFixed(2):((1*this.feed_price+1*this.product_price)*this.form.show_sku.sum).toFixed(2)},lineprice:function(){return((1*this.feed_price+1*this.product_lineprice)*this.form.show_sku.sum).toFixed(2)},isadd:function(){return this.form.show_sku.sum>=this.stock||this.form.show_sku.sum>=this.form.detail.limit_num},issub:function(){return this.form.show_sku.sum<=1}},props:["productModel"],created(t){let e=this.productModel;this.product_id=e.product_id,this.delivery=e.delivery,this.bag_type=e.bag_type,this.dinner_type=e.dinner_type,this.cart_type=e.cart_type,this.table_id=e.table_id,this.shop_supplier_id=e.shop_supplier_id,this.clock=!1,this.getData(),this.isWeixin()&&(this.isMPH5=!0)},methods:{closeFunc(t){this.$emit("close")},openVideo(t){"video"==t?(this.isVideoPlay=!0,this.isContentVideoPlay=!1):(this.isVideoPlay=!1,this.isContentVideoPlay=!0)},bag_price:function(){return(this.form.show_sku.bag_price*this.form.show_sku.sum).toFixed(2)||0},goback(){u({success:()=>{},fail:()=>{n({url:"/pages/index/index"})}})},getData(){let t=this;p({title:"加载中...",mask:!0}),t._get("product.product/detail",{product_id:t.product_id,table_id:t.table_id||0,shop_supplier_id:t.shop_supplier_id||0},(e=>{_(),e.data.detail?(e.data.detail.content=h.format_content(e.data.detail.content),t.detail=e.data.detail,t.loading=!1,this.showGoodDetailModal()):t.showError("商品已下架",(()=>{t.closeFunc(!1)}))}))},showGoodDetailModal(){let t=this;this.detail.sku.forEach(((t,e)=>{t.checked=!1}));let e={specData:this.detail.sku,detail:this.detail,shop_supplier_id:this.detail.shop_supplier_id,productSpecArr:null!=this.specData?new Array(this.specData.spec_attr.length):[],show_sku:{sku_image:"",seckill_price:0,attr:[],product_sku_id:[],feed:[],line_price:0,seckill_stock:0,seckill_product_sku_id:0,sum:1}};t.form=e,t.space_name="",t.attr_name=[],t.feed_name=[],t.isOpenSpec=!0,t.initShowSku(),0==t.form.detail.sku[0].checked&&t.selecedtSpec(t.form.detail.sku[0],0),""!=t.form.detail.product_attr&&t.form.detail.product_attr.forEach(((e,s)=>{t.form.show_sku.attr[s]||t.selectAttr(e.attribute_value[0],0,s)}))},describe:function(){let t=this.space_name;""!=t&&(t+=";");let e=this.attr_name.join(";");""!=e&&(e+=";");let s=this.feed_name.join(",");return""!=s&&(s+=";"),t+e+s||""},initShowSku(){this.form.show_sku.sku_image=this.form.detail.product_image,this.form.show_sku.product_price=this.form.detail.product_price,this.form.show_sku.bag_price=this.form.detail.bag_price,this.form.show_sku.product_sku_id=[],this.form.show_sku.attr=[],this.form.show_sku.feed=[],this.form.show_sku.feed.length=this.form.detail.product_feed.length,this.form.show_sku.line_price=this.form.detail.line_price,this.form.show_sku.stock_num=this.form.detail.product_stock,this.form.show_sku.sum=1,this.stock=this.form.detail.product_stock},selecedtSpec(t,e){let s=this;t.checked?(t.checked=!1,s.form.show_sku.product_sku_id[0]=null):(s.form.detail.sku.forEach(((t,e)=>{t.checked=!1})),t.checked=!0,s.form.show_sku.product_sku_id[0]=t.product_sku_id,s.space_name=t.spec_name,s.$set(s.form.show_sku,"product_price",t.product_price),s.$set(s.form.show_sku,"bag_price",t.bag_price),s.$set(s.form.show_sku,"line_price",t.line_price),s.$set(s.form.show_sku,"stock_num",t.stock_num)),null!=s.form.show_sku.product_sku_id[0]?s.updateSpecProduct():s.initShowSku()},selectAttr(t,e,s){let i=this;i.$set(i.form.show_sku.attr,s,e),i.attr_name[s]=t,i.updateSpecProduct()},selectFeed(t,e){let s=this;if(s.form.show_sku.feed[e]||0===s.form.show_sku.feed[e]){s.$set(s.form.show_sku.feed,e,null),s.feed_price-=1*t.price,t.discount_price?s.discount_price-=t.discount_price:s.discount_price-=0;let i=s.feed_name.indexOf(t.feed_name);i>-1&&s.feed_name.splice(i,1)}else s.$set(s.form.show_sku.feed,e,e),s.feed_price+=1*t.price,t.discount_price?s.discount_price+=t.discount_price:s.discount_price+=0,s.feed_name.push(t.feed_name);s.updateSpecProduct()},updateSpecProduct(){this.product_price=this.form.show_sku.product_price,this.product_lineprice=this.form.show_sku.line_price},add(){this.stock<=0?m({title:"商品库存不足",icon:"none",duration:2e3}):this.form.show_sku.sum++},sub(){if(!(this.stock<=0))return this.form.show_sku.sum<2?(m({title:"商品数量至少为1",icon:"none",duration:2e3}),!1):void this.form.show_sku.sum--},confirmFunc(){if(console.log(this.clock),!this.clock)if(null!=this.form.show_sku.product_sku_id[0]||20!=this.form.detail.spec_type){if(null!=this.form.detail.product_attr)for(let t=0;t<this.form.detail.product_attr.length;t++)if(null==this.form.show_sku.attr[t])return void m({title:"请选择属性",icon:"none",duration:2e3});this.form.show_sku.sum>this.form.show_sku.stock_num?m({title:"商品库存不足",icon:"none",duration:2e3}):this.addCart()}else m({title:"请选择规格",icon:"none",duration:2e3})},addCart(){let t=this,e=[];t.form.show_sku.feed.forEach(((t,s)=>{null!=t&&e.push(t)})),e=e.length<=0?"":e.join(",");let s="";s=t.discount_price?1*t.discount_price+1*t.product_price:1*t.feed_price+1*t.product_price;let i={product_id:t.form.detail.product_id,product_num:t.form.show_sku.sum,product_sku_id:t.form.show_sku.product_sku_id[0],attr:t.form.show_sku.attr.join(","),feed:e,describe:t.describe(),price:s,product_price:1*t.feed_price+1*t.form.show_sku.line_price,bag_price:t.form.show_sku.bag_price,shop_supplier_id:t.form.shop_supplier_id,cart_type:t.cart_type,dinner_type:t.dinner_type,delivery:t.delivery,table_id:t.table_id||0};t.clock=!0,p({title:"",mask:!0}),t._post("order.cart/add",i,(function(e){t.clock=!1,_(),t.$emit("close",t.form.show_sku.sum,e)}),(e=>{t.clock=!1}))}}},[["render",function(t,c,d,u,n,p){const _=r,h=A,m=C;return n.loading?a("",!0):(e(),s(_,{key:0,class:"pop-spec"},{default:i((()=>[l(_,{class:"pop-bg",onClick:c[0]||(c[0]=o((t=>p.closeFunc(!1)),["stop"]))}),l(_,{class:y(["good-detail-modal",t.theme()||""]),"data-theme":t.theme()},{default:i((()=>[l(_,{class:"icon iconfont icon-guanbi1",onClick:c[1]||(c[1]=o((t=>p.closeFunc(!1)),["stop"]))}),l(_,{class:"product-images"},{default:i((()=>[n.detail.product_image?(e(),s(h,{key:0,src:n.detail.product_image,class:"product-image",mode:"aspectFill"},null,8,["src"])):a("",!0)])),_:1}),l(_,{class:"product-name f-s-0"},{default:i((()=>[l(_,{class:"text-ellipsis"},{default:i((()=>[f(k(n.detail.product_name||""),1)])),_:1})])),_:1}),l(_,{class:"good_basic"},{default:i((()=>[l(_,{class:"f22 gray9"},{default:i((()=>[f("已售"+k(n.detail.product_sales||""),1)])),_:1}),n.detail.selling_point?(e(),s(_,{key:0,class:"gray6 sell-point",style:{"line-height":"1.5"}},{default:i((()=>[f(k(n.detail.selling_point||""),1)])),_:1})):a("",!0)])),_:1}),l(_,{class:"product-specs"},{default:i((()=>[20==n.detail.spec_type?(e(),s(_,{key:0,class:"property"},{default:i((()=>[l(_,{class:"title"},{default:i((()=>[l(m,{class:"name"},{default:i((()=>[f("规格")])),_:1})])),_:1}),l(_,{class:"values"},{default:i((()=>[(e(!0),g(b,null,w(n.detail.sku,((t,a)=>(e(),s(_,{class:y(["value",{default:t.checked}]),onClick:o((e=>p.selecedtSpec(t,a)),["stop"]),key:a},{default:i((()=>[f(k(t.spec_name),1)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1})):a("",!0),n.detail.product_attr.length>0?(e(!0),g(b,{key:1},w(n.detail.product_attr,((t,c)=>(e(),s(_,{class:"property",key:c},{default:i((()=>[l(_,{class:"title"},{default:i((()=>[l(m,{class:"name"},{default:i((()=>[f(k(t.attribute_name||""),1)])),_:2},1024)])),_:2},1024),l(_,{class:"values"},{default:i((()=>[(e(!0),g(b,null,w(t.attribute_value,((t,l)=>(e(),g(b,null,[""!=t?(e(),s(_,{class:y(["value",{default:n.form.show_sku.attr[c]==l}]),onClick:o((e=>p.selectAttr(t,l,c)),["stop"]),key:l},{default:i((()=>[f(k(t),1)])),_:2},1032,["onClick","class"])):a("",!0)],64)))),256))])),_:2},1024)])),_:2},1024)))),128)):a("",!0),n.detail.product_feed.length>0?(e(),s(_,{key:2,class:"property"},{default:i((()=>[l(_,{class:"title"},{default:i((()=>[l(m,{class:"name"},{default:i((()=>[f("加料")])),_:1})])),_:1}),l(_,{class:"values"},{default:i((()=>[(e(!0),g(b,null,w(n.detail.product_feed,((t,a)=>(e(),s(_,{class:y(["value",{default:null!=n.form.show_sku.feed[a]}]),onClick:o((e=>p.selectFeed(t,a)),["stop"]),key:a},{default:i((()=>[f(" +"+k(t.feed_name),1)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1})):a("",!0)])),_:1}),l(_,{class:"product-content"},{default:i((()=>[l(_,{class:"border-b-e"},{default:i((()=>[l(_,{class:"group-hd d-s-c"},{default:i((()=>[l(m,{class:"min-name pr f30 fb"},{default:i((()=>[f("详情")])),_:1})])),_:1})])),_:1}),l(_,{class:"content-box"},{default:i((()=>[l(_,{class:"",innerHTML:n.detail.content},null,8,["innerHTML"])])),_:1})])),_:1}),l(_,{class:"spec-bottom"},{default:i((()=>[l(_,{class:"action"},{default:i((()=>[l(_,{class:"d-c d-a-s"},{default:i((()=>[l(_,{class:"d-s-c"},{default:i((()=>[l(m,{class:"f42 theme-price"},{default:i((()=>[f("￥")])),_:1}),l(m,{class:"f48 mr16 theme-price"},{default:i((()=>[f(k(p.price||0),1)])),_:1}),l(m,{class:"f22 gray9 fb text-l-t mr8"},{default:i((()=>[f("￥"+k(p.lineprice||0),1)])),_:1}),1!=n.bag_type?(e(),s(m,{key:0,class:"f22 gray9"},{default:i((()=>[f("打包费￥"+k(p.bag_price()||0),1)])),_:1})):a("",!0)])),_:1}),l(_,{class:"f22 gray3"},{default:i((()=>[f(k(p.describe()||""),1)])),_:1})])),_:1}),l(_,{class:"btn-group"},{default:i((()=>[l(h,{onClick:c[2]||(c[2]=o((t=>p.sub()),["stop"])),class:"add-image",src:"/static/icon/cart/reduce-"+t.theme()+".png"},null,8,["src"]),l(_,{class:"number"},{default:i((()=>[f(k(n.form.show_sku.sum),1)])),_:1}),n.stock>0?(e(),s(h,{key:0,onClick:c[3]||(c[3]=o((t=>p.add()),["stop"])),class:"add-image",src:"/static/icon/cart/add-"+t.theme()+".png",mode:""},null,8,["src"])):(e(),s(h,{key:1,onClick:c[4]||(c[4]=o((t=>p.add()),["stop"])),class:"add-image",src:I,mode:""}))])),_:1})])),_:1}),l(_,null,{default:i((()=>[l(_,{class:"addCart-btn",onClick:p.confirmFunc},{default:i((()=>[l(_,null,{default:i((()=>[f("加入购物车")])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["data-theme","class"])])),_:1}))}],["__scopeId","data-v-1e7a8cd2"]]),M="/h5/assets/loading-DdOdyAUj.gif";export{E as _,M as a,I as b,S as p};
