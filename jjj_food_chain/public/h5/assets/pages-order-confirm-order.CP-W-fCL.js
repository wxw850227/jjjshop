import{_ as e,p as t,j as a,o as s,c as i,w as r,a as l,b as d,r as o,F as c,e as n,C as u,d as p,h as _,t as m,g as y,k as f,v as h,z as k,I as b,B as g,i as v}from"./index-g5-6g3i5.js";import{P as x}from"./uni-popup.D_CVBUk_.js";import{r as D}from"./uni-app.es.JON5rhdf.js";/* empty css                                                                  */const w=e({components:{Popup:x},data:()=>({width:750,height:600,dataModel:{},minute:["10","25","40","55"],hours:[{start:"00",end:"02"},{start:"02",end:"04"},{start:"04",end:"06"},{start:"06",end:"08"},{start:"08",end:"10"},{start:"10",end:"12"},{start:"12",end:"14"},{start:"14",end:"16"},{start:"16",end:"18"},{start:"18",end:"20"},{start:"20",end:"22"},{start:"22",end:"24"}],myhours:"",myminute:"",pickhours:{start:"",end:""},mealtime:""}),props:["isTimer"],onShow(){},watch:{isTimer:function(e,t){e!=t&&this.getData()}},methods:{getData(){let e=this,t=new Date;e.myhours=t.getHours(),e.myminute=t.getMinutes(),e.pickH(e.hours[e.myhours]),e.$nextTick((function(){e.hours.forEach(((t,a)=>{t.start<=e.myhours&&e.myhours<t.end&&e.pickH(t)}))}))},pickH(e){this.pickhours=e},hidePopupFunc(e){this.$emit("close","")},picktime(e){this.mealtime=e,this.$emit("close",this.mealtime)},inittime(e){let t=e;return t=1*e-1,e<=10?"0"+t:t},copyQQ(e){var a=document.createElement("input");a.value=e,document.body.appendChild(a),a.select(),a.setSelectionRange(0,a.value.length),document.execCommand("Copy"),document.body.removeChild(a),t({title:"复制成功",icon:"success",mask:!0,duration:2e3})}}},[["render",function(e,t,f,h,k,b){const g=n,v=u,x=a("Popup");return s(),i(x,{show:f.isTimer,width:k.width,height:k.height,padding:0,onHidePopup:b.hidePopupFunc,type:"bottom"},{default:r((()=>[l(g,{class:"d-b-c time_picker"},{default:r((()=>[l(g,{class:"",style:{width:"40%"}},{default:r((()=>[l(v,{style:{height:"600rpx"},"scroll-y":"true"},{default:r((()=>[(s(!0),d(c,null,o(k.hours,((e,t)=>(s(),d(c,{key:t},[k.myhours<=e.end?(s(),i(g,{key:0,class:p(k.pickhours&&e.start!=k.pickhours.start?"hours":"hours-active"),onClick:t=>b.pickH(e)},{default:r((()=>[_(m(e.start+":00~"+e.end+":00"),1)])),_:2},1032,["class","onClick"])):y("",!0)],64)))),128))])),_:1})])),_:1}),l(g,{class:"flex-1"},{default:r((()=>[l(v,{style:{height:"600rpx"},"scroll-y":"true"},{default:r((()=>[(s(!0),d(c,null,o(k.minute,((e,t)=>(s(),d(c,{key:t},[k.pickhours&&k.myhours>=k.pickhours.start&&k.myminute<=e&&k.myhours!=b.inittime(k.pickhours.end)?(s(),i(g,{key:0,onClick:t=>b.picktime(k.pickhours.start+":"+e)},{default:r((()=>[_(m(k.pickhours.start+":"+e),1)])),_:2},1032,["onClick"])):y("",!0)],64)))),128)),(s(!0),d(c,null,o(k.minute,((e,t)=>(s(),d(c,{key:t},[k.pickhours&&k.myhours<=k.pickhours.start&&k.myhours!=b.inittime(k.pickhours.end)?(s(),i(g,{key:0,onClick:t=>b.picktime(k.pickhours.start+":"+e)},{default:r((()=>[_(m(k.pickhours.start+":"+e),1)])),_:2},1032,["onClick"])):y("",!0)],64)))),128)),(s(!0),d(c,null,o(k.minute,((e,t)=>(s(),d(c,{key:t},[k.pickhours&&k.myhours!=b.inittime(k.pickhours.end)?(s(),i(g,{key:0,onClick:t=>b.picktime(b.inittime(k.pickhours.end)+":"+e)},{default:r((()=>[_(m(b.inittime(k.pickhours.end)+":"+e),1)])),_:2},1032,["onClick"])):y("",!0)],64)))),128)),(s(!0),d(c,null,o(k.minute,((e,t)=>(s(),d(c,{key:t},[k.pickhours&&k.myminute<=e&&k.myhours==b.inittime(k.pickhours.end)?(s(),i(g,{key:0,onClick:t=>b.picktime(b.inittime(k.pickhours.end)+":"+e)},{default:r((()=>[_(m(b.inittime(k.pickhours.end)+":"+e),1)])),_:2},1032,["onClick"])):y("",!0)],64)))),128))])),_:1})])),_:1})])),_:1})])),_:1},8,["show","width","height","onHidePopup"])}],["__scopeId","data-v-8915680b"]]);const O=e({components:{timepicker:w},data:()=>({loading:!0,options:{},tab_type:0,product_id:"",product_num:"",ProductData:[],OrderData:[],exist_address:!1,Address:{region:[]},extract_store:{},last_extract:{},product_sku_id:0,delivery:0,linkman:"",phone:"",remark:"",deliverySetting:[],temlIds:[],showAlipay:!1,takeout_address:{},isTimer:!1,mealtime:"",wmtime:"",estitime:"",is_pack:1,supplier:{},dinner_type:10,cart_type:0,store_set:[],delivery_set:[],table_id:0,min_money:0}),onLoad(e){let t=this;t.options=e,t.cart_type=e.cart_type,t.table_id=e.table_id||0,t.dinner_type=e.dinner_type,t.delivery=e.delivery},onShow(){this.$fire.on("takeout",(function(e){self.takeout_address=e,self.orderType="takeout"})),this.getData()},methods:{hasType(e){return-1!=this.deliverySetting.indexOf(e)},changeTime(e){},getTime(e){let t=new Date,a=t.getHours();a<10&&(a="0"+a);let s=t.getMinutes();s<10&&(s="0"+s);let i=t.getHours(),r=t.getMinutes()+15;return r>=60&&(r-=60,i+=1),r<10&&(r="0"+r),i<10&&(i="0"+i),"my"==e?a+":"+s:"wm"==e?i+":"+r:void 0},getData(){let e=this;f({title:"加载中"}),e.loading=!0;let t=function(t){e.OrderData=t.data.orderInfo,e.min_money=t.data.orderInfo.supplier.min_money,e.temlIds=t.data.template_arr,e.exist_address=e.OrderData.exist_address,e.Address=e.OrderData.address,e.extract_store=e.OrderData.extract_store,e.last_extract=e.OrderData.last_extract,e.ProductData=e.OrderData.product_list,e.supplier=t.data.orderInfo.supplier,e.linkman=t.data.orderInfo.last_extract.linkman,e.phone=t.data.orderInfo.last_extract.phone,e.delivery_set=t.data.orderInfo.supplier.delivery_set,e.store_set=t.data.orderInfo.supplier.store_set,"10"==e.OrderData.delivery&&(e.tab_type=0),"20"==e.OrderData.delivery&&(e.tab_type=1),"30"==e.OrderData.delivery&&(e.tab_type=3),"40"==e.OrderData.delivery&&(e.tab_type=4),0==e.cart_type?-1==e.delivery_set.indexOf(e.delivery)&&("10"==e.delivery_set[0]?(console.log("执行"),e.tabFunc(0,!0)):e.tabFunc(1,!0)):-1==e.store_set.indexOf(e.delivery)&&("30"==e.store_set[0]?e.tabFunc(3,!0):e.tabFunc(4,!0)),e.wmtime=e.getTime("wm"),e.mealtime=e.getTime("my"),e.estitime=e.getTime("wm"),e.deliverySetting=e.OrderData.deliverySetting,e.loading=!1},a={delivery:e.delivery||0,store_id:1,mealtime:"",pay_source:e.getPlatform()};e.table_id&&(a.table_id=e.table_id),"buy"===e.options.order_type?e._get("order.order/buy",Object.assign({},a,{product_id:e.options.product_id,product_num:e.options.product_num,product_sku_id:e.options.product_sku_id}),(function(e){t(e)})):"cart"===e.options.order_type&&e._get("order.order/cart",Object.assign({},a,{cart_ids:e.options.cart_ids||0,shop_supplier_id:e.options.shop_supplier_id||0,order_type:e.options.cart_type,table_id:e.table_id}),(function(e){t(e)}),(function(t){1==e.tab_type?e.tabFunc(0):0==e.tab_type&&e.tabFunc(1)}))},tabFunc(e,t){0==e&&1*this.min_money>1*this.OrderData.order_pay_price?this.showError("未满足最低配送费用!"):(this.tab_type=e,0==e?(this.delivery="10",this.dinner_type=10):1==e?(this.delivery="20",this.dinner_type=20):3==e?(this.delivery="30",this.dinner_type=30):4==e&&(this.delivery="40",this.dinner_type=30),t||(console.log("切换"),this.getData()))},SubmitOrder(){let e=this;if(this.loading)return;let t={delivery:e.delivery,store_id:1,linkman:e.linkman,phone:e.phone,remark:e.remark,mealtime:e.mealtime,shop_supplier_id:e.options.shop_supplier_id,pay_source:e.getPlatform()};10==e.delivery&&(t.mealtime=e.wmtime),1==e.tab_type&&10!=e.delivery&&(t.mealtime=e.getTime("my"));let a="";"buy"===e.options.order_type&&(a="order.order/buy",t=Object.assign(t,{product_id:e.options.product_id,product_num:e.options.product_num,product_sku_id:e.options.product_sku_id})),"cart"===e.options.order_type&&(a="order.order/cart",t=Object.assign(t,{cart_ids:e.options.cart_ids||0,dinner_type:e.dinner_type,shop_supplier_id:e.options.shop_supplier_id||0,order_type:e.options.cart_type,table_id:e.table_id}));e.subMessage(e.temlIds,(function(){e.loading=!0,f({title:"加载中",mask:!0}),e._post(a,t,(function(t){let a="/pages/order/cashier?order_type=10&order_id="+t.data.order_id;e.gotoPage(a,"reLaunch")}),(t=>{e.loading=!1}))}))},timepick(){this.isTimer=!0},closetimer(e){""!=e&&(this.wmtime=e,this.mealtime=e),this.isTimer=!1},packTypeFunc(e){this.is_pack=e}}},[["render",function(e,t,a,u,f,x){const O=k,C=n,T=b,F=v,P=g,I=D(h("timepicker"),w);return s(),i(C,{"data-theme":e.theme(),class:p(e.theme()||"")},{default:r((()=>[f.loading?y("",!0):(s(),i(C,{key:0,class:"wrap"},{default:r((()=>[0==f.cart_type?(s(),i(C,{key:0,class:"right"},{default:r((()=>[(s(!0),d(c,null,o(f.delivery_set,((e,a)=>(s(),d(c,{key:a+"1"},["10"==e?(s(),i(C,{key:0,class:p(["takeout d-c-c",0==f.tab_type?"active":""]),onClick:t[0]||(t[0]=e=>x.tabFunc(0))},{default:r((()=>[l(C,{class:"d-c-c"},{default:r((()=>[l(O,{class:"icon-waimai1 icon iconfont top-icon"}),l(O,null,{default:r((()=>[_("配送")])),_:1})])),_:1})])),_:1},8,["class"])):y("",!0)],64)))),128)),(s(!0),d(c,null,o(f.delivery_set,((e,a)=>(s(),d(c,{key:a+"2"},["20"==e?(s(),i(C,{key:0,class:p(["dinein d-c-c",1==f.tab_type?"active":""]),onClick:t[1]||(t[1]=e=>x.tabFunc(1))},{default:r((()=>[l(C,{class:"d-c-c"},{default:r((()=>[l(O,{class:"icon-wodedianpu icon iconfont top-icon"}),l(O,null,{default:r((()=>[_("自取")])),_:1})])),_:1})])),_:1},8,["class"])):y("",!0)],64)))),128))])),_:1})):y("",!0),1==f.cart_type?(s(),i(C,{key:1,class:"right"},{default:r((()=>[(s(!0),d(c,null,o(f.store_set,((e,a)=>(s(),d(c,{key:e},["30"==e?(s(),i(C,{key:0,class:p(["takeout d-c-c",3==f.tab_type?"active":""]),onClick:t[2]||(t[2]=e=>x.tabFunc(3))},{default:r((()=>[l(C,{class:"d-c-c"},{default:r((()=>[l(O,{class:"icon-waimai icon iconfont top-icon"}),l(O,null,{default:r((()=>[_("打包")])),_:1})])),_:1})])),_:1},8,["class"])):y("",!0)],64)))),128)),(s(!0),d(c,null,o(f.store_set,((e,a)=>(s(),d(c,{key:e},["40"==e?(s(),i(C,{key:0,class:p(["dinein d-c-c",4==f.tab_type?"active":""]),onClick:t[3]||(t[3]=e=>x.tabFunc(4))},{default:r((()=>[l(C,{class:"d-c-c"},{default:r((()=>[l(O,{class:"icon-dianneijiucan icon iconfont top-icon"}),l(O,null,{default:r((()=>[_("堂食")])),_:1})])),_:1})])),_:1},8,["class"])):y("",!0)],64)))),128))])),_:1})):y("",!0),0==f.cart_type?(s(),i(C,{key:2,class:"header"},{default:r((()=>[l(C,{class:"headr_top"},{default:r((()=>[1!=f.tab_type?(s(),i(C,{key:0,class:"flex-1",style:{width:"100%"}},{default:r((()=>[l(C,{class:"left overflow-hidden"},{default:r((()=>[l(C,{class:"overflow-hidden w-b-a",style:{width:"600rpx"},onClick:t[4]||(t[4]=t=>e.gotoPage("/pages/user/address/storeaddress?shop_supplier_id="+f.options.shop_supplier_id))},{default:r((()=>[null!=f.Address?(s(),d(c,{key:0},[l(C,{class:"f32 fb gray3 mb20",style:{"word-break":"break-all"}},{default:r((()=>[_(m(f.Address.detail+f.Address.address),1)])),_:1}),l(C,{class:"f28 gray3"},{default:r((()=>[_(m(f.Address.name)+"("+m(f.Address.phone)+")",1)])),_:1})],64)):(s(),d(c,{key:1},[_(" 请选择配送地址 ")],64))])),_:1})])),_:1})])),_:1})):y("",!0),1==f.tab_type?(s(),i(C,{key:1,class:"header_bottom d-b-c"},{default:r((()=>[l(C,{class:"shop-info",style:{width:"430rpx"}},{default:r((()=>[l(C,{class:"f32 fb mb10"},{default:r((()=>[_(m(f.supplier.name),1)])),_:1}),l(C,{class:"gray9 shop-address"},{default:r((()=>[_(m(f.supplier.address),1)])),_:1})])),_:1}),l(C,{class:"d-c d-c-c"},{default:r((()=>[l(C,{class:"icon iconfont icon-address shop-pop-icon"})])),_:1})])),_:1})):y("",!0)])),_:1}),1==f.tab_type&&10!=f.delivery?(s(),i(C,{key:0,class:"d-b-c meal_item"},{default:r((()=>[l(C,{class:"f28"},{default:r((()=>[_("预留电话")])),_:1}),l(T,{modelValue:f.phone,"onUpdate:modelValue":t[5]||(t[5]=e=>f.phone=e),type:"text",class:"header-input",placeholder:"请输入"},null,8,["modelValue"])])),_:1})):y("",!0),1==f.tab_type&&10!=f.delivery?(s(),i(C,{key:1,class:"d-b-c meal_item"},{default:r((()=>[l(C,{class:"f28"},{default:r((()=>[_("取餐时间")])),_:1}),l(C,{class:""},{default:r((()=>[l(O,{class:"f32 theme-price"},{default:r((()=>[_(m(f.estitime),1)])),_:1})])),_:1})])),_:1})):y("",!0),0==f.tab_type&&10==f.delivery?(s(),i(C,{key:2,class:"d-b-c meal_item",onClick:t[6]||(t[6]=e=>x.timepick())},{default:r((()=>[l(C,{class:"f28"},{default:r((()=>[_("预计送达时间")])),_:1}),l(C,{class:""},{default:r((()=>[l(O,{class:"theme-price f32"},{default:r((()=>[_(m(f.wmtime),1)])),_:1}),l(O,{class:"icon iconfont icon-jiantou"})])),_:1})])),_:1})):y("",!0)])),_:1})):y("",!0),l(C,{class:"vender"},{default:r((()=>[l(C,{class:"left d-s-c"},{default:r((()=>[l(C,{class:"store-name"},{default:r((()=>[l(O,null,{default:r((()=>[_(m(f.supplier.name),1)])),_:1})])),_:1})])),_:1}),l(C,{class:"list"},{default:r((()=>[(s(!0),d(c,null,o(f.ProductData,((e,t)=>(s(),i(C,{class:"item d-b-c",key:t},{default:r((()=>[l(C,{class:"info d-s-s"},{default:r((()=>[l(C,{class:"cover"},{default:r((()=>[l(F,{src:e.image.file_path,mode:"aspectFill"},null,8,["src"])])),_:2},1024),l(C,{class:"flex-1"},{default:r((()=>[l(C,{class:"f30 fb mb16"},{default:r((()=>[_(m(e.product.product_name),1)])),_:2},1024),l(C,{class:"num-wrap pl-30 gray9 f26"},{default:r((()=>[_(m(e.describe),1)])),_:2},1024),l(C,{class:"f26 gray9"},{default:r((()=>[_("×"+m(e.product_num),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),l(C,{class:"",style:{height:"148rpx","text-align":"right"}},{default:r((()=>[l(C,{class:"f32 order_item mb16"},{default:r((()=>[_("¥"+m(e.price),1)])),_:2},1024),l(C,{class:"f24 text-d-line gray9 mb16"},{default:r((()=>[_("¥"+m(e.product_price),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),l(C,{class:"other_box"},{default:r((()=>[l(C,{class:"item"},{default:r((()=>[l(O,{class:"key"},{default:r((()=>[_("商品小计：")])),_:1}),l(O,{class:"f32"},{default:r((()=>[_("￥"+m(f.OrderData.order_total_price),1)])),_:1})])),_:1}),l(C,{class:"item"},{default:r((()=>[l(O,{class:"key"},{default:r((()=>[_("包装费用：")])),_:1}),l(O,{class:"f32"},{default:r((()=>[_("￥"+m(f.OrderData.order_bag_price),1)])),_:1})])),_:1}),1!=f.tab_type&&0!=f.OrderData.express_price?(s(),i(C,{key:0,class:"item"},{default:r((()=>[l(O,{class:"key"},{default:r((()=>[_("配送费：")])),_:1}),l(C,null,{default:r((()=>[f.OrderData.total_express_price!=f.OrderData.express_price?(s(),i(O,{key:0,class:"gray9 f32 text-d-line"},{default:r((()=>[_(m(f.OrderData.total_express_price),1)])),_:1})):y("",!0),l(O,{class:"f32"},{default:r((()=>[_(m(f.OrderData.express_price),1)])),_:1})])),_:1})])),_:1})):y("",!0),f.OrderData.table_no?(s(),i(C,{key:1,class:"item"},{default:r((()=>[l(O,{class:"key"},{default:r((()=>[_("桌号：")])),_:1}),l(O,{class:"f32"},{default:r((()=>[_(m(f.OrderData.table_no),1)])),_:1})])),_:1})):y("",!0)])),_:1}),l(C,{class:"total-box"},{default:r((()=>[_(" 共"+m(f.OrderData.order_total_num)+"件商品 小计 ",1),l(O,{class:"f32 fb ml15"},{default:r((()=>[_("￥"+m(f.OrderData.order_pay_price),1)])),_:1})])),_:1})])),_:1}),l(C,{class:"remarks"},{default:r((()=>[l(C,{class:"d-b-c item"},{default:r((()=>[l(C,{class:"mr20"},{default:r((()=>[_("备注:")])),_:1}),l(T,{class:"flex-1",type:"text",modelValue:f.remark,"onUpdate:modelValue":t[7]||(t[7]=e=>f.remark=e),placeholder:"请填写您的其他要求"},null,8,["modelValue"])])),_:1})])),_:1}),l(C,{class:"foot-pay-btns"},{default:r((()=>[f.OrderData.force_points?y("",!0):(s(),i(C,{key:0,class:"price"},{default:r((()=>[_(" ¥ "),l(O,{class:"num"},{default:r((()=>[_(m(f.OrderData.order_pay_price),1)])),_:1})])),_:1})),l(P,{class:"theme-btn",onClick:x.SubmitOrder},{default:r((()=>[_("提交订单")])),_:1},8,["onClick"])])),_:1}),l(I,{isTimer:f.isTimer,onClose:x.closetimer},null,8,["isTimer","onClose"])])),_:1}))])),_:1},8,["data-theme","class"])}],["__scopeId","data-v-b90a42bc"]]);export{O as default};
