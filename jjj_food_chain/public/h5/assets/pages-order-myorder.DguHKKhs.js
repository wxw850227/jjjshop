import{_ as e,E as a,k as t,m as s,p as l,j as o,c as r,w as d,d as i,e as c,o as n,a as u,h as p,b as _,r as g,F as f,i as m,B as h,J as y,t as k,g as b,z as D}from"./index-g5-6g3i5.js";import{u as x}from"./uni-load-more.DhP9XK6d.js";const C=e({components:{uniLoadMore:x},data:()=>({topRefresh:!1,listData:[],dataType:1,order_id:0,last_page:0,page:1,list_rows:10,no_more:!1,loading:!0}),computed:{loadingType(){return this.loading?1:0!=this.listData.length&&this.no_more?2:0}},onShow(){this.initData(),this.getData()},onReachBottom(){let e=this;e.page<e.last_page&&(e.page++,e.getData()),e.no_more=!0},methods:{initData(){let e=this;e.page=1,e.listData=[],e.no_more=!1},orderStateFunc(e){let a=this;a.loading||a.dataType!=e&&(a.page=1,a.loading=!0,a.listData=[],a.dataType=e,a.getData())},getData(){if(!this.getUserId())return void(this.loading=!1);let e=this;e.loading=!0,e._get("user.order/lists",{dataType:e.dataType,page:e.page,list_rows:e.list_rows},(function(a){e.loading=!1,e.listData=e.listData.concat(a.data.list.data),e.last_page=a.data.list.last_page,a.data.list.last_page<=1?e.no_more=!0:e.no_more=!1}))},gotoOrder(e){this.gotoPage("/pages/order/order-detail?order_id="+e)},onPayOrder(e){let a="/pages/order/cashier?order_type=10&order_id="+e;this.gotoPage(a,"reLaunch")},orderReceipt(e){let o=this;a({title:"提示",content:"您确定要收货吗?",success:function(a){a.confirm?(t({title:"正在处理",mask:!0}),o._post("user.order/receipt",{order_id:e},(function(e){s(),l({title:e.msg,duration:2e3,icon:"success"}),o.listData=[],o.getData()}))):l({title:"取消收货",duration:1e3,icon:"none"})}})},cancelOrder(e){let o=this,r=e;a({title:"提示",content:"您确定要取消吗?",success:function(e){e.confirm&&(t({title:"正在处理",mask:!0}),o._get("user.order/cancel",{order_id:r},(function(e){s(),l({title:"操作成功",duration:2e3,icon:"success"}),o.listData=[],o.getData()})))}})},gohome(){this.gotoPage("/pages/index/index")}}},[["render",function(e,a,t,s,l,x){const C=c,T=D,v=m,O=h,P=o("uni-load-more");return n(),r(C,{"data-theme":e.theme(),class:i(e.theme()||"")},{default:d((()=>[u(C,{class:"top-tabbar d-a-c"},{default:d((()=>[u(C,{class:i(1==l.dataType?"tab-item active":"tab-item"),onClick:a[0]||(a[0]=e=>x.orderStateFunc(1))},{default:d((()=>[p("当前订单")])),_:1},8,["class"]),u(C,{class:i(2==l.dataType?"tab-item active":"tab-item"),onClick:a[1]||(a[1]=e=>x.orderStateFunc(2))},{default:d((()=>[p("历史订单")])),_:1},8,["class"])])),_:1}),u(C,{class:"order-list"},{default:d((()=>[(n(!0),_(f,null,g(l.listData,((e,a)=>(n(),r(C,{class:"item",key:a,onClick:y((a=>x.gotoOrder(e.order_id)),["stop"])},{default:d((()=>[u(C,{class:"d-b-c pb14"},{default:d((()=>[u(T,{class:"order-tips"},{default:d((()=>[p(k(e.order_label),1)])),_:2},1024),u(C,{class:"item-dianpu flex-1"},{default:d((()=>[u(C,{class:"item-d-l mr10"},{default:d((()=>[e.supplier?(n(),r(T,{key:0,class:"gray3 f28 fb text-ellipsis"},{default:d((()=>[p(k(e.supplier.name),1)])),_:2},1024)):b("",!0)])),_:2},1024)])),_:2},1024),u(C,{class:"state"},{default:d((()=>[u(T,{class:"gray9 f24"},{default:d((()=>[p(k(e.state_text),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),u(C,{class:"product-list pr d-b-c"},{default:d((()=>[u(C,{class:"o-a flex-1"},{default:d((()=>[u(C,{class:"list d-s-c pr100"},{default:d((()=>[(n(!0),_(f,null,g(e.product,((e,a)=>(n(),_(f,null,[a<=2?(n(),r(C,{class:"cover mr20",key:a},{default:d((()=>[u(v,{src:e.image?e.image.file_path:"",mode:"aspectFit"},null,8,["src"]),u(C,{class:"mt10 tc f24 text-ellipsis"},{default:d((()=>[p(k(e.product_name),1)])),_:2},1024)])),_:2},1024)):b("",!0)],64)))),256))])),_:2},1024)])),_:2},1024),u(C,null,{default:d((()=>[u(C,{class:"theme-price f30"},{default:d((()=>[p("￥"),u(T,{class:"f36"},{default:d((()=>[p(k(e.pay_price),1)])),_:2},1024)])),_:2},1024),u(C,{class:"f20 gray6 tr"},{default:d((()=>[p("共"+k(e.productNum)+"件",1)])),_:2},1024)])),_:2},1024)])),_:2},1024),u(T,{class:"shop-name flex-1"},{default:d((()=>[p("下单时间："+k(e.create_time),1)])),_:2},1024),10==e.order_status.value?(n(),r(C,{key:0,class:"order-bts"},{default:d((()=>[10==e.pay_status.value&&30!=e.order_source?(n(),r(O,{key:0,class:"default",onClick:y((a=>x.cancelOrder(e.order_id)),["stop"]),type:"default"},{default:d((()=>[p("取消订单")])),_:2},1032,["onClick"])):b("",!0),10==e.pay_status.value&&30!=e.order_source?(n(),r(O,{key:1,class:"theme-btn fb",onClick:y((a=>x.onPayOrder(e.order_id)),["stop"])},{default:d((()=>[p("立即支付")])),_:2},1032,["onClick"])):b("",!0),10==e.pay_status.value&&30==e.order_source&&1==e.supplier.pay_open?(n(),r(O,{key:2,class:"theme-btn fb",onClick:y((a=>x.onPayOrder(e.order_id)),["stop"])},{default:d((()=>[p("立即支付")])),_:2},1032,["onClick"])):b("",!0)])),_:2},1024)):b("",!0)])),_:2},1032,["onClick"])))),128)),0!=l.listData.length||l.loading?(n(),r(P,{key:1,loadingType:x.loadingType},null,8,["loadingType"])):(n(),r(C,{key:0,class:"d-c-c d-c p30"},{default:d((()=>[u(v,{style:{width:"268rpx",height:"263rpx","margin-top":"123rpx"},src:"/h5/assets/no-order-BOuPUwgm.png",mode:"aspectFill"}),u(C,{class:"f26 gray9"},{default:d((()=>[p("暂无记录")])),_:1}),u(C,null,{default:d((()=>[u(O,{class:"btn-normal theme-btn",onClick:a[2]||(a[2]=a=>e.gotoPage("/pages/index/index"))},{default:d((()=>[p("立即点单")])),_:1})])),_:1})])),_:1}))])),_:1})])),_:1},8,["data-theme","class"])}],["__scopeId","data-v-359409de"]]);export{C as default};
