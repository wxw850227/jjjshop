import{_ as e,L as t,M as a,E as s,l,p as o,q as i,s as r,D as d,o as c,c as p,w as n,n as u,f as _,a as g,g as h,d as y,h as f,b as m,r as b,F as v,i as w,A as k,k as x,C,N as D,t as P,j as F}from"./index-61e49878.js";import{P as H}from"./uni-popup.5fe8e197.js";import{u as I}from"./uni-load-more.aa58dc35.js";/* empty css                                                                  */const T=e({components:{Popup:H,uniLoadMore:I},data:()=>({checkedPay:[10,20],order_type:0,phoneHeight:0,scrollviewHigh:0,state_active:0,topRefresh:!1,listData:[],dataType:0,isPayPopup:!1,order_id:0,last_page:0,page:1,list_rows:10,no_more:!1,loading:!0,isCodeImg:!1,codeImg:"",showAlipay:!1,isfirst:!1,statusBarHeight:0,titleBarHeight:0,delivery_type:10}),computed:{loadingType(){return this.loading?1:0!=this.listData.length&&this.no_more?2:0}},onReady(e){this.init()},mounted(){},onShow(){this.initData(),this.getData()},methods:{initData(){let e=this;e.page=1,e.listData=[],e.no_more=!1},init(){let e=this;t({success(t){e.phoneHeight=t.windowHeight,a().in(e).select(".top-tabbar").boundingClientRect((t=>{let a=e.phoneHeight-t.height;e.scrollviewHigh=a})).exec()}})},ordertypeFunc(e){let t=this;t.loading||(t.order_type!=e&&0==e?(t.page=1,t.loading=!0,this.order_type=e,t.listData=[],this.delivery_type=10,this.dataType=0,t.getData()):t.order_type!=e&&1==e&&(t.page=1,t.loading=!0,t.listData=[],this.order_type=e,this.delivery_type=40,this.dataType=0,t.getData()))},orderStateFunc(e){let t=this;t.loading||t.delivery_type!=e&&(t.page=1,t.loading=!0,t.listData=[],t.delivery_type=e,t.getData())},scrolltolowerFunc(){let e=this;e.no_more||(e.page++,e.page<=e.last_page?e.getData():e.no_more=!0)},getData(){if(!this.getUserId())return void(this.loading=!1);let e=this;e.loading=!0,e._get("user.order/lists",{dataType:e.dataType,page:e.page,list_rows:e.list_rows,order_type:e.order_type,delivery_type:e.delivery_type},(function(t){e.loading=!1,e.listData=e.listData.concat(t.data.list.data),e.last_page=t.data.list.last_page,t.data.list.last_page<=1?e.no_more=!0:e.no_more=!1,e.isfirst=!0}))},gotoOrder(e){this.gotoPage("/pages/order/order-detail?order_id="+e)},onPayOrder(e){let t="/pages/order/cashier?order_type=10&order_id="+e;this.gotoPage(t,"reLaunch")},orderReceipt(e){let t=this;s({title:"提示",content:"您确定要收货吗?",success:function(a){a.confirm?(l({title:"正在处理"}),t._post("user.order/receipt",{order_id:e},(function(e){o(),i({title:e.msg,duration:2e3,icon:"success"}),t.listData=[],t.getData()}))):i({title:"取消收货",duration:1e3,icon:"none"})}})},cancelOrder(e){let t=this,a=e;s({title:"提示",content:"您确定要取消吗?",success:function(e){e.confirm&&(l({title:"正在处理"}),t._get("user.order/cancel",{order_id:a},(function(e){o(),i({title:"操作成功",duration:2e3,icon:"success"}),t.listData=[],t.getData()})))}})},addOrder(e,t){r("selectedId",t),this.gotoPage("pages/product/list/store?order_id="+e)},gotoEvaluate(e){d({url:"/pages/order/evaluate/evaluate?order_id="+e})},onQRCode(e){let t=this;l({title:"加载中"});let a=e,s=t.getPlatform();t._get("user.order/qrcode",{order_id:a,source:s},(function(e){o(),t.isCodeImg=!0,t.codeImg=e.data.qrcode}))},hideCodePopupFunc(){this.isCodeImg=!1},gotoAssembleShare(e){d({url:"/pages/plus/assemble/fight-group-detail/fight-group-detail?assemble_bill_id="+e})},gohome(){this.gotoPage("/pages/index/index")}}},[["render",function(e,t,a,s,l,o){const i=_,r=w,d=F,H=k,I=x("uni-load-more"),T=C,S=x("Popup");return c(),p(i,{"data-theme":e.theme(),class:u(e.theme()||"")},{default:n((()=>[g(i,{class:"top-tabbar"},{default:n((()=>[g(i,{class:"ww100",style:h("height:"+e.topBarTop()+"px;")},null,8,["style"]),g(i,{class:"ww100",style:"height:30rpx;"}),g(i,{class:"tc head_top",style:h(0==e.topBarHeight()?"":"height:"+e.topBarHeight()+"px;")},{default:n((()=>[g(i,{class:"d-c-c bg-white"},{default:n((()=>[g(i,{class:u(["left",0==l.order_type?"tab-item-top active":"tab-item-top"]),onClick:t[0]||(t[0]=e=>o.ordertypeFunc(0))},{default:n((()=>[y("配送订单")])),_:1},8,["class"]),g(i,{class:u(["right",1==l.order_type?"tab-item-top active":"tab-item-top"]),onClick:t[1]||(t[1]=e=>o.ordertypeFunc(1))},{default:n((()=>[y("店内订单")])),_:1},8,["class"])])),_:1})])),_:1},8,["style"]),0==l.order_type?(c(),p(i,{key:0,class:"d-a-c ww100 mt24"},{default:n((()=>[g(i,{class:u(10==l.delivery_type?"tab-item active":"tab-item"),onClick:t[2]||(t[2]=e=>o.orderStateFunc(10))},{default:n((()=>[y("外送订单 ")])),_:1},8,["class"]),g(i,{class:u(20==l.delivery_type?"tab-item active":"tab-item"),onClick:t[3]||(t[3]=e=>o.orderStateFunc(20))},{default:n((()=>[y("自提订单 ")])),_:1},8,["class"])])),_:1})):f("",!0),1==l.order_type?(c(),p(i,{key:1,class:"d-a-c ww100 mt24"},{default:n((()=>[g(i,{class:u(40==l.delivery_type?"tab-item active":"tab-item"),onClick:t[4]||(t[4]=e=>o.orderStateFunc(40))},{default:n((()=>[y("堂食订单 ")])),_:1},8,["class"]),g(i,{class:u(30==l.delivery_type?"tab-item active":"tab-item"),onClick:t[5]||(t[5]=e=>o.orderStateFunc(30))},{default:n((()=>[y("打包订单 ")])),_:1},8,["class"])])),_:1})):f("",!0)])),_:1}),g(T,{"scroll-y":"true",class:"scroll-Y",style:h("height:"+l.scrollviewHigh+"px;"),"lower-threshold":"50",onScrolltolower:o.scrolltolowerFunc},{default:n((()=>[g(i,{class:u(l.topRefresh?"top-refresh open":"top-refresh")},{default:n((()=>[(c(),m(v,null,b(3,((e,t)=>g(i,{class:"circle",key:t}))),64))])),_:1},8,["class"]),g(i,{class:"order-list"},{default:n((()=>[(c(!0),m(v,null,b(l.listData,((e,t)=>(c(),p(i,{class:"item d-b-s",key:t,onClick:D((t=>o.gotoOrder(e.order_id)),["stop"])},{default:n((()=>[g(i,{class:"mr10"},{default:n((()=>[g(r,{class:"sup_img",src:e.supplier.logo||"/static/default.png",mode:"aspectFill"},null,8,["src"])])),_:2},1024),g(i,{class:"flex-1"},{default:n((()=>[g(i,{class:"d-b-c pb14"},{default:n((()=>[g(i,{class:"item-dianpu"},{default:n((()=>[g(i,{class:"item-d-l mr10"},{default:n((()=>[e.supplier?(c(),p(d,{key:0,class:"gray3 f28 fb text-ellipsis",style:{width:"245rpx"}},{default:n((()=>[y(P(e.supplier.name),1)])),_:2},1024)):f("",!0)])),_:2},1024)])),_:2},1024),g(i,{class:"state"},{default:n((()=>[g(d,{class:"dominant f26"},{default:n((()=>[y(P(e.state_text),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),g(i,{class:"order-head d-b-c"},{default:n((()=>[g(i,null,{default:n((()=>[g(d,{class:"shop-name flex-1"},{default:n((()=>[y("下单时间："+P(e.create_time),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),g(i,{class:"product-list pr"},{default:n((()=>[g(i,{class:"o-a pr150"},{default:n((()=>[g(i,{class:"list d-s-c pr100"},{default:n((()=>[(c(!0),m(v,null,b(e.product,((e,t)=>(c(),p(i,{class:"cover mr20",key:t},{default:n((()=>[g(r,{src:e.image?e.image.file_path:"",mode:"aspectFit"},null,8,["src"]),g(i,{class:"mt10 tc f24 text-ellipsis"},{default:n((()=>[y(P(e.product_name),1)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)])),_:2},1024),g(i,{class:"order-bts"},{default:n((()=>[10==e.order_status.value?(c(),m(v,{key:0},[10==e.pay_status.value&&30!=e.order_source?(c(),p(H,{key:0,class:"default",onClick:D((t=>o.cancelOrder(e.order_id)),["stop"]),type:"default"},{default:n((()=>[y("取消订单")])),_:2},1032,["onClick"])):f("",!0),10==e.pay_status.value?(c(),p(H,{key:1,class:"theme-borderbtn fb",onClick:D((t=>o.onPayOrder(e.order_id)),["stop"])},{default:n((()=>[y("立即支付")])),_:2},1032,["onClick"])):f("",!0),10==e.pay_status.value&&40==e.delivery_type?(c(),p(H,{key:2,class:"theme-borderbtn fb",onClick:D((t=>o.addOrder(e.order_id,e.supplier.shop_supplier_id)),["stop"])},{default:n((()=>[y("加菜")])),_:2},1032,["onClick"])):f("",!0)],64)):f("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128)),0!=l.listData.length||l.loading?(c(),p(I,{key:1,loadingType:o.loadingType},null,8,["loadingType"])):(c(),p(i,{key:0,class:"d-c-c d-c p30"},{default:n((()=>[g(r,{style:{width:"268rpx",height:"263rpx","margin-top":"123rpx"},src:"/h5/assets/no-order-951811af.png",mode:"aspectFill"}),g(i,{class:"f26 gray9"},{default:n((()=>[y("暂无记录")])),_:1}),g(i,null,{default:n((()=>[g(H,{class:"btn-normal",onClick:t[6]||(t[6]=t=>e.gotoPage("/pages/index/index"))},{default:n((()=>[y("立即点单")])),_:1})])),_:1})])),_:1}))])),_:1})])),_:1},8,["style","onScrolltolower"]),g(S,{show:l.isCodeImg,type:"middle",onHidePopup:o.hideCodePopupFunc},{default:n((()=>[g(i,{class:"ww100 p20 box-s-b"},{default:n((()=>[g(r,{class:"ww100",src:l.codeImg,mode:"widthFix"},null,8,["src"])])),_:1})])),_:1},8,["show","onHidePopup"])])),_:1},8,["data-theme","class"])}],["__scopeId","data-v-c054377d"]]);export{T as default};
